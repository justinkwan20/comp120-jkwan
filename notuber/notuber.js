var lat=-99999,lng=-99999;function getLocation(){navigator.geolocation.getCurrentPosition(function(e){lat=e.coords.latitude,lng=e.coords.longitude,init()})}function init(){var e=new google.maps.LatLng(lat,lng);s={zoom:13,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP},i=new google.maps.Map(document.getElementById("map_canvas"),s),r=new google.maps.Marker({position:e,title:"Your Location"});var o=new XMLHttpRequest,t=`username=jLV8vyGV&lat=${lat}&lng=${lng}`;o.open("POST","https://jordan-marsh.herokuapp.com/rides",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){var t=Number.POSITIVE_INFINITY;if(4==o.readyState&&200==o.status){var a=o.responseText,n=JSON.parse(a);for(let o in n){var l=new google.maps.LatLng(n[o].lat,n[o].lng),s=new google.maps.Marker({position:l,icon:"car.png"});if(google.maps.geometry.spherical.computeDistanceBetween(e,l)<t){t=google.maps.geometry.spherical.computeDistanceBetween(e,l);var g={lat:n[o].lat,lng:n[o].lng}}s.setMap(i)}var p=[{lat:lat,lng:lng},{lat:g.lat,lng:g.lng}];new google.maps.Polyline({path:p,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}).setMap(i)}new google.maps.places.PlacesService(i).nearbySearch({location:e,radius:1609.34,type:"restaurant"},(e,o)=>{if(o===google.maps.places.PlacesServiceStatus.OK&&e)for(let o=0;o<e.length;o++)markerSetter(e[o],i)}),r=new google.maps.Marker({position:e,title:"Your Location"}),r.setMap(i);var c="<h3> Your Location </h3><p> The closest uber is: <b>"+621371e-9*t+"</b> miles away</p>",m=new google.maps.InfoWindow({content:c});google.maps.event.addListener(r,"click",function(){m.setContent(c),m.open(i,r)})},o.send(t)}function markerSetter(e,o){var t=new google.maps.InfoWindow,a=new google.maps.Marker({position:e.geometry.location});google.maps.event.addListener(a,"click",()=>{t.setContent(e.name||""),t.open(o,a)}),a.setMap(o)}